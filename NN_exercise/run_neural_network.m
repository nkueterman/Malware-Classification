clear; close all; clc;

%% Data preprocessing
% load data and display random samples
load('Sample_MNIST.mat')
randX = randi(size(X,1),100,1);
[figHandle, display_array] = displayData(X(randX,:));

% preprocess features
X = horzcat(ones(length(y),1), X);

% model parameters
nHidden  = 25;
nClasses = 10;
n = 10000;
alpha = 0.1;

% initialize weights
theta1   = (0.24).*rand(nHidden,size(X,2)) - 0.12;
theta2   = (0.24).*rand(nClasses,nHidden+1) - 0.12;

% caluclate cost
[J,theta1,theta2] = nn_backpropagation(theta1,theta2,nClasses,nHidden,X,y,n,alpha);
J(end)

%% Predict classes

[yPred] = determine_output(theta1,theta2,X);

% calculate overall accuracy
accuracy = nnz(yPred'==y)/length(y)

